<a name="br1"></a> 

Software Production Engineering

Course Project

IMT2020110 Vivek Tagudu

IMT2020085 Harshadeep Donapati

**Introduction**

This is a Library Management System designed in React for adding books,

issuing books, editing issues, and more. We used the MERN stack (MongoDB,

Express, React, and NodeJS) to build this application.

**Github Repo Link: <https://github.com/harsha-deep/Lib>**

**Deployed Application Link: <https://library-odfb.onrender.com/>**

**DevOps tools:**

**Source Control Management:** Git and GitHub

**Continuous Integration Pipeline:** Jenkins

**Containerization:** Docker

**Container Orchestration:** Docker compose



<a name="br2"></a> 

**Front End:** React, Tailwind CSS, Antd

**Logger:** Winston

**Monitoring:** ELK Stack

**Database:** MongoDB

**Testing:** Chai, Jest

**Other dependencies**

**● bcryptjs -** For password hashing

● **jsonwebtoken** - For JWT auth

**● express -** For the backend server

● **mongoose** - For MongoDB operations

● **dotenv** - Dealing with environment variables

**Features**

**● Register**

New Users can register with the system.

**● Login**

Registered users can log in to the system with their credentials.

2



<a name="br3"></a> 

**● List of available books**

Upon logging in, the user will be displayed a list of books and each

book has a tag about their availability. (Available/Not Available)

3



<a name="br4"></a> 

**● Access Management**

There are 3 types of users - normal users(patron), the librarian, and the

admin. All tabs are visible to the admin only. (He has the highest

control over the system.)

**List of tabs**

**● General**

This tab shows the general details of the logged-in user.

4



<a name="br5"></a> 

**● Books Borrowed tab**

This tab shows the list of borrowed books by the user.

**● Books tab**

This tab shows the general details of a book (book image, book title,

category, author, publisher, total copies, available copies, added date,

and various actions (discussed later).

This tab is not visible to the user.

5



<a name="br6"></a> 

**● Delete book**

The bin icon (on the right-hand side) can be used to delete the book.

**● Edit book**

The pencil icon can be used to edit the book details. It renders a

popup form with already ﬁlled details which can be edited and saved.

6



<a name="br7"></a> 

**● Issue a book**

A book can be issued by clicking the issue book link.

**● List of Issues**

The admin/librarian can see the issues of the book with some basic

details ( to whom it was issued, when it was issued etc.)

**● Return the book**

The admin/librarian can click the return book button if the user has

returned a book.

7



<a name="br8"></a> 

**● Delete an issue**

The admin/librarian can delete the issue using the delete button.

**● Students/Librarians/Admins tab**

The admin/librarian can see a list of all students with basic details

(name, email, phone number, etc.)

The admin/librarian can also see a user’s issued books by clicking the

“Books” button.

8



<a name="br9"></a> 

**● Reports tab**

Only the admin can see the report tab which contains all the details

about the whole system. This includes every detail about books, users,

issues, and the whole revenue generated by the system.

9



<a name="br10"></a> 

**Docker**

**Front-end docker ﬁle**

**Backend docker ﬁle**

10



<a name="br11"></a> 

This Dockerﬁle is for a Node.js application. It starts with the Node.js 21 as the base

image, sets the working directory to /app, installs the nodemon tool globally for

automatic server restarts, and then copies the package.json and package-lock.json

ﬁles to the container before running npm ci to install dependencies. The application

code is then copied into the container, and it exposes port 5002/3000. The ﬁnal

command in the Dockerﬁle utilizes nodemon to run the backend server and npm to

run the frontend server.

**Jenkins**

We used Jenkins pipeline scm from GitHub. The pipeline script was cloned from the

GitHub repository And the code was also cloned from the same repository.

The ﬁrst step was to clone the repo.

The second step is to build the front-end image. All the contents are required to

build the front-end image

11



<a name="br12"></a> 

Similarly, the next step is to build the back-end image.

The next step is to push the docker images to the DockerHub.

12



<a name="br13"></a> 

We can use the docker [image/container] prune command to delete old docker and

dangling docker images/containers.

Using Ansible, we can start the docker images by assigning the port and declaring

the environment variables.

13



<a name="br14"></a> 

**Jenkins Pipeline Result**

Playbook.yml has the permissions to the docker-compose and start docker images.

14



<a name="br15"></a> 

**Deployments**

**Using localhost**

**npm start:** start the front-end

Environment variables for the front-end.

**REACT\_APP\_BASE\_URL=[http://localhost:5001**](http://localhost:5001)**

**nodemon server:** Start the front end.

Environment variables for back-end.

**jwt\_secret**=secret

**MONGO\_URL=mongodb+srv://vivektangudu:viv@cluster0.czt49ﬁ.mongodb.net**

**/lib PORT=5001 NODE\_ENV**=development

Here we used a cloud database.

**Using docker-compose**

● While using docker images, we used the Mongo DB docker image to connect

to the database.

These images connect between them using a network name “mynetwork”.

Communication happens using the local host.

● The front-end image exposes the 3000 port and it connects to localhost:3000

● The backend image exposes to 5000 port and it connects to localhost:5000

● Similarly, mongo\_db exposes to 27017, and it connects to the backend.

15



<a name="br16"></a> 

The URL can be **“mongodb://mongodb\_db:27027/mydatabase”** or

**“mongodb://localhost:27017/mydatabase”**

16



<a name="br17"></a> 

This Docker Compose ﬁle deﬁnes a multi-container environment for a full-stack

application with a frontend, backend, and MongoDB database. It utilizes three

services: "container\_front" for the frontend, "container\_back" for the backend, and

"mongodb\_db" for the MongoDB database. The frontend and backend containers

are connected to the "mynetwork" network, enabling communication. The

"container\_front" service exposes its application on port 3001, forwarding requests

to the backend hosted on port 5002. The backend relies on a MongoDB database

with connection details speciﬁed in the environment variables. Additionally, the

MongoDB container is exposed on port 27017, we can observe the activity in the

Mongodb compass.

Deployment from docker-compose.

17



<a name="br18"></a> 

Logs from the backend docker.

**Deployed in render.com**

**Front-end:** A static website. The environment variable is the link of the backend

service.

<https://library-odfb.onrender.com/>

**Backend-end:** a web service. Mongodb database is the cloud database.

<https://back-j9al.onrender.com/>

Here the render uses the webhooks from GitHub to build the update the

webservices when there is an update in the code.

18



<a name="br19"></a> 

**Deployed in K8**

Deployed in Kubernetes.

These are logs from my backend pod. We deployed the mongo\_db image in a pod.

And we use that pod to connect with the backend as the database.

19



<a name="br20"></a> 

**kubectl port-forward <front-end pod name> 3001:3000**

**kubectl port-forward <backend pod name> 5005:5000**

We use the above commands to expose the pods to localhost.

**API Documentation**

The **"/api/users"** route handles user-related operations, allowing for the

management of user data. The **"/api/books"** route facilitates interactions with

book-related data, oﬀering endpoints for book-related operations. The

**"/api/issues"** route is responsible for handling issues or transactions related to

the books, providing endpoints for managing book transactions.

Every response has a tag with success. If the response is true, it means the

operation is passed, and if the response is false it means the operation is failed,

along with an error message.

**/api/users/login**

Helps to log in to the user with email and password.

There are diﬀerent errors that can pop up in diﬀerent situations.

20



<a name="br21"></a> 

→ If a valid username doesn't exist.

→ If a valid password doesn't match.

Passwords are usually encrypted and saved in db. While checking the password, it

decrypts the password and checks the password.

→ Last type of message can be a success or it can be a failure.

21



<a name="br22"></a> 

If the login passes, it will send a token to the front end that will be saved in the

client system as a cache for further processing.

**api/users/register**

This api works while registering a user. There can be diﬀerent error messages that

can pop up based on the input.

→ Should be a unique email and phone number.

22



<a name="br23"></a> 

The password is usually saved in db after encrypting the user password.

23



<a name="br24"></a> 

**api/users/get-logged-in-user**

We are using cache to store the logged-in user name. If a user re-visits the website.

We use the token and verify the user.

For any operation that is done by the user, a token is sent in the payload to do the

operations. It asks like a middleware to authenticate for any operation. The possible

errors can be:

24



<a name="br25"></a> 

25



<a name="br26"></a> 

**api/users/get-all-users**

To get all users based on role. This can be used by only admin and staﬀ.

**api/books/add-book**

**api/books/update-book/:id**

Update book details or copy numbers. We pass the ID of the book and update it

accordingly.

26



<a name="br27"></a> 

**api/books/delete-book/:id**

Similarly, we can delete books using the id of the book.

**api/books/get-all-books**

To get a list of all books.

**/api/issues/issue-new-book**

When a librarian is issuing a new book. We use this

27



<a name="br28"></a> 

28



<a name="br29"></a> 

**api/issues/get-user-id-by-email**

While issuing a new book, we verify the user's mail address and get the user ID for

further things.

**/api/issues/get-issues**

This is primarily used by the admin to get all issues by each user. user details are

mentioned in the payload.

29



<a name="br30"></a> 

Similarly, we can delete issues.

**/api/reports/get-reports**

This api can be used by only the admin. To get all the information in the database.

**Testing**

We did testing for both the backend and front end using jest and chai.

To do testing we used a separate database in the localhost and tried to add some

users and update their details similarly for books.

30



<a name="br31"></a> 

These changes are reﬂected in the db.

Front-end testing, we did for components and the login and register page.

We tried creating diﬀerent button types and checking for the desired type.

We have changed the environment variables accordingly for testing.

31



<a name="br32"></a> 

**Logging**

We used the Winston package for logging. We logged every operation and calls that

were made in the backend along with the result, time, and type of deployment (test,

info, error).

[2023-12-13 17:42:00.513] [info] get all books, success

[2023-12-13 17:49:12.449] **[error]** get all books, failed

**Webhooks**

Webhooks were used by render.com. As we deployed the frontend and

backend in the cloud. We connected the webhook to the cloud to update the

build automatically.

Those were some deployments using webhooks when there was a commit.

**ELK stack**

Grok pattern( timestamp ("YYYY-MM-DD HH:mm:ss.SSS") + info/error +

message))

32



<a name="br33"></a> 

ELK stack consists of 3 applications: Elasticsearch, Logstash, and Kibana. ELK stack

is useful for collecting logs from all applications, analyzing these logs, and creating

visualizations.

Each log has a Timestamp, deployment type (info/ error), and message.

33



<a name="br34"></a> 

**Errors**

\1) Initially, we had no idea about proxy, later we added an environment variable

to api calls. This is not an error but we changed the api calls on every page.

\2) Communication between front-end and back-end images after creating

docker images. Later we got to know about the network and communication

between them.

\3) In Harsha’s system, process\.env\.ENVIRONMENT\_VARIABLE was not working\.

But a workaround for this was to specify export in the .env ﬁle (which is not

required generally) and add an absolute path (not a relative path to the

dotenv.conﬁg() function.)

\4) In Harsha’s system while running Jenkins builds, as Jenkins uses

/var/lib/jenkins to install all the npm packages, the root ‘/’ directory ran out of

space and the system crashed. After rebooting, the system went into a login

loop which prompted the user for username and password repeatedly even

after entering the correct credentials. This problem was resolved by booting

34



<a name="br35"></a> 

into recovery mode and deleting some unnecessary software and older Linux

kernels to free up some space in the root directory.

**Future Scope**

●

Replicate the same for renting any other objects like cars or any other

things.

● Add functionality for the admin to change the roles of users from the web.

● Instead of giving an image URL for the book, an image upload button can be

added.

**References**

● Class Slides

● [stackoverﬂow.com](http://stackoverflow.com)[ ](http://stackoverflow.com)for debugging various errors and other warnings

● <https://tailwindcss.com/docs/>[ ](https://tailwindcss.com/docs/)for utility classes

● [https://stackoverﬂow.com/a/11104156/15069364](https://stackoverflow.com/a/11104156/15069364)[ ](https://stackoverflow.com/a/11104156/15069364)For process.env error

● Jacob Bhaiya’s “Chapter 3 Simple Calculator Program.pdf” for Jenkinsﬁle

● <https://docs.docker.com/get-started/02_our_app/>

● <https://minikube.sigs.k8s.io/docs/start/>[ ](https://minikube.sigs.k8s.io/docs/start/)for k8’s

● <https://docs.docker.com/get-started/docker_cheatsheet.pdf>

**Note**

● [@harsha-deep](https://github.com/harsha-deep)[ ](https://github.com/harsha-deep)does not have any commits in the Github Repo because

[@vivektangudu123](https://github.com/vivektangudu123)[ ](https://github.com/vivektangudu123)did a git force push and all other commits and code was

gone.

35

